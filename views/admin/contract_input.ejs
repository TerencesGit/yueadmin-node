<!DOCTYPE html>
<html>
  <head>
    <%- include('../link') %>
  </head>
  <body>
    <%- include('../aside') %>
    <%- include('../header') %>
    <div id="main" class="main" data-page="contract_manage">
      <div class="wrapper animated fadeInRight">
        <div class="container-fluid">
          <div class="panel panel-primary">
            <div class="panel-heading">
              <h3 class="panel-title">
                <span><%=title%></span>
                <a href="javascript:history.go(-1)" class="pull-right">返回</a>
              </h3>
            </div>
            <div class="panel-body">
              <div class="alert alert-info">
                <i class="fa fa-info-circle"></i>
                提示：请填写合同真实信息，*表示必填项，附件为文档（支持doc、docx、pdf格式）或图片（支持jpg、jpeg、png、gif格式）
                <a class="close" data-dismiss="alert" href="#" aria-hidden="true">
                  &times;
                </a>
              </div>
              <form action="/admin/save_contract" method="post" id="contractForm" class="form-horizontal m-t" role="form" enctype="multipart/form-data">
                <input type="hidden" name="contract[id]" value="<%=contract._id%>">
                <div class="form-group row">
                  <label class="control-label col-md-2"><i>*</i>合同编号</label>
                  <div class="col-md-7">
                    <input type="text" name="contract[contract_code]" id="contractCode" class="form-control" placeholder="请输入合同编号" value="<%=contract.contract_code%>"/>
                  </div>
                </div>
                <div class="form-group row">
                  <label class="control-label col-md-2"><i>*</i>甲方姓名</label>
                  <div class="col-md-7">
                    <input type="text" name="contract[party_a_name]" id="partyAName" class="form-control" placeholder="请输入甲方姓名" value="<%=contract.party_a_name%>"/>
                  </div>
                </div>
                <div class="form-group row">
                  <label class="control-label col-md-2"><i>*</i>乙方姓名</label>
                  <div class="col-md-7">
                    <input type="text" name="contract[party_b_name]" id="partyBName" class="form-control" placeholder="请输入乙方姓名" value="<%=contract.party_b_name%>"/>
                  </div>
                </div>
                <div class="form-group row">
                  <label class="control-label col-md-2">丙方姓名</label>
                  <div class="col-md-7">
                    <input type="text" name="contract[party_c_name]" id="partyCName" class="form-control" placeholder="请输入丙方姓名" value="<%=contract.party_c_name%>"/>
                  </div>
                </div>
                <div class="form-group row">
                  <label class="control-label col-md-2"><i>*</i>签署时间</label>
                  <div class="col-md-7">
                    <input type="text" name="contract[sign_time]" id="signDate" class="form-control laydate-icon" placeholder="签署时间与纸质合同保持一致" value="<%=contract.sign_time%>"/>
                  </div>
                </div>
                <div class="form-group row">
                  <label class="control-label col-md-2"><i>*</i>生效时间</label>
                  <div class="col-md-7">
                    <input type="text" name="contract[effetive_date]" id="effetiveDate" class="form-control laydate-icon" placeholder="生效时间" value="<%=contract.effetive_date%>"/>
                  </div>
                </div>
                <div class="form-group row">
                  <label class="control-label col-md-2"><i>*</i>失效时间</label>
                  <div class="col-md-7">
                    <input type="text" name="contract[expire_date]" id="expireDate" class="form-control laydate-icon" placeholder="失效时间" value="<%=contract.expire_date%>"/>
                  </div>
                </div>
                <div class="form-group row">
                  <label class="control-label col-md-2">选择模板</label>
                  <div class="col-md-7">
                    <%if(contract.template){%>
                    <input type="hidden" id="contractId" value="<%=contract.template%>"/>
                    <%}%>
                    <select name="contract[template]" id="contractTemplate" class="form-control selector">
                      <% templates.forEach(function(template, index){%>
                      <option value="<%= template._id%>"><%= template.name%></option>
                      <%})%>
                    </select>
                  </div>
                </div>
                <div class="form-group row">
                  <label class="control-label col-md-2">附件1</label>
                  <div class="col-md-7">
                    <input type="file" name="attach_file_1" class="attach-file">
                    <div class="input-group">
                      <span class="input-group-btn">
                        <button type="button" class="btn btn-primary attach-upload">选择文件</button>
                      </span>
                      <input type="text" class="form-control file-name" disabled="true" placeholder="未选择任何文件" value="<%= contract.attach_file_1%>">
                    </div>
                  </div>
                </div>
                <div class="form-group row">
                  <label class="control-label col-md-2">附件2</label>
                  <div class="col-md-7">
                    <input type="file" name="attach_file_2" class="attach-file">
                    <div class="input-group">
                      <span class="input-group-btn">
                        <button type="button" class="btn btn-primary attach-upload">选择文件</button>
                      </span>
                      <input type="text" class="form-control file-name" disabled="true" placeholder="未选择任何文件">
                    </div>
                  </div>
                </div>
                <div class="form-group row">
                  <label class="control-label col-md-2">附件3</label>
                  <div class="col-md-7">
                    <input type="file" name="attach_file_3" class="attach-file">
                    <div class="input-group">
                      <span class="input-group-btn">
                        <button type="button" class="btn btn-primary attach-upload">选择文件</button>
                      </span>
                      <input type="text" class="form-control file-name" disabled="true" placeholder="未选择任何文件">
                    </div>
                  </div>
                </div>
                <div class="form-group row">
                  <label class="control-label col-md-2">附件4</label>
                  <div class="col-md-7">
                    <input type="file" name="attach_file_4" class="attach-file">
                    <div class="input-group">
                      <span class="input-group-btn">
                        <button type="button" class="btn btn-primary attach-upload">选择文件</button>
                      </span>
                      <input type="text" class="form-control file-name" disabled="true" placeholder="未选择任何文件">
                    </div>
                  </div>
                </div>
                <div class="form-group row">
                  <label for="contractCont" class="control-label col-md-2">备注</label>
                  <div class="col-md-7">
                   <textarea name="contract[note]" id="contractCont" rows="5" class="form-control" placeholder="备注"><%=contract.note%></textarea>
                  </div>
                </div>
                <div class="form-group row">
                  <div class="col-md-offset-5">
                    <button type="submit" id="contractSubmit" class="btn btn-primary">提交</button>
                    <button type="reset" class="btn btn-default m-l">重置</button>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
        <div class="warp-footer"></div>
      </div>
    	<%- include('../footer') %>
    </div>
    <%- include('../script')%>
    <script src="/plugins/laydate/laydate.js"></script>
    <script src="/js/contract.js"></script>
    <script>
      //日期选择器
      const sign = {
        elem: '#signDate',
        max: laydate.now(),
        choose: function(datas){
           effetive.min = datas;
        }
      };
      const effetive = {
        elem: '#effetiveDate',
        choose: function(datas){
           expire.min = datas;
           expire.start = datas;
        }
      };
      const expire = {
        elem: '#expireDate',
        min: laydate.now(),
        choose: function(datas){
           effetive.max = datas;
           effetive.end = datas;
        }
      };
      laydate(sign)
      laydate(effetive)
      laydate(expire)
      $('#contractId').length === 1 && $('.selector').val($('#contractId').val());
    </script>
  </body>
</html>
