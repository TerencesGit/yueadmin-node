<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>悦视觉</title>
  <link rel="shortcut icon" href="img/favicon.ico">
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="css/font-awesome.min.css">
  <link rel="stylesheet" href="css/animate.min.css">
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="plugins/zTree/css/zTreeStyle.css">
  <style>
    .ztree li span.button.add {
      margin-left: 2px;
      margin-right: -1px;
      background-position: -144px 0;
      vertical-align: top;
    }
    form{
      padding: 20px;
      background: #fff
    }
  </style>
  <!--[if lt IE 9]>
      <meta http-equiv="refresh" content="0;ie.html" />
  <![endif]-->
</head>
<body>
<!-- 侧边栏 -->
  <aside id="aside">
  	<div class="sidebar">
  		<div class="sidebar-header">
      <h4>
				<i class="fa fa-flag"></i>
				<strong>悦视觉</strong>
			</h4>
    </div>
    <div class="divide-line"></div>
    <ul id="accordion" class="accordion">
      <li>
        <div class="link">
          <i class="fa fa-home"></i>
          <a href="#">首页</a>
        </div>
      </li>
       <li>
        <div class="link">
          <i class="fa fa-user"></i>账户管理<i class="fa fa-chevron-down"></i>
        </div>
        <ul class="submenu">
          <li><a href="#">账户信息维护</a></li>
          <li><a href="#">修改账户密码</a></li>
          <li><a href="#">注册我的企业</a></li>
        </ul>
      </li>
      <li class="open">
        <div class="link"><i class="fa fa-desktop"></i>我的企业管理<i class="fa fa-chevron-down"></i></div>
        <ul class="submenu">
          <li class="active"><a href="#">组织部门管理</a></li>
          <li><a href="#">员工管理</a></li>
          <li><a href="#">部门权限管理</a></li>
          <li><a href="#">信息维护</a></li>
          <li><a href="#">账户代注册</a></li>
          <li><a href="#">岗位管理</a></li>
        </ul>
      </li>
      <li>
        <div class="link">
          <i class="fa fa-group"></i> 我所管理的商家
          <i class="fa fa-chevron-down"></i>
        </div>
        <ul class="submenu">
          <li><a href="#">商家维护</a></li>
          <li><a href="#">商家信息审核</a></li>
          <li><a href="#">合同管理</a></li>
          <li><a href="#">权限管理</a></li>
          <li><a href="#">管辖分配</a></li>
        </ul>
      </li>
      <li>
        <div class="link">
          <i class="fa fa-globe"></i> 系统管理
          <i class="fa fa-chevron-down"></i>
        </div>
        <ul class="submenu">
          <li><a href="#">系统功能树管理</a></li>
          <li><a href="#">系统角色管理</a></li>
          <li><a href="#">公告信息维护</a></li>
          <li><a href="#">系统内账户维护</a></li>
        </ul>
      </li>
       <li>
        <div class="link">
          <i class="fa fa-globe"></i> 系统管理
          <i class="fa fa-chevron-down"></i>
        </div>
        <ul class="submenu">
          <li><a href="#">系统功能树管理</a></li>
          <li><a href="#">系统角色管理</a></li>
          <li><a href="#">公告信息维护</a></li>
          <li><a href="#">系统内账户维护</a></li>
        </ul>
      </li>
       <li>
        <div class="link">
          <i class="fa fa-globe"></i> 系统管理
          <i class="fa fa-chevron-down"></i>
        </div>
        <ul class="submenu">
          <li><a href="#">系统功能树管理</a></li>
          <li><a href="#">系统角色管理</a></li>
          <li><a href="#">公告信息维护</a></li>
          <li><a href="#">系统内账户维护</a></li>
        </ul>
      </li>
       <li>
        <div class="link">
          <i class="fa fa-globe"></i> 系统管理
          <i class="fa fa-chevron-down"></i>
        </div>
        <ul class="submenu">
          <li><a href="#">系统功能树管理</a></li>
          <li><a href="#">系统角色管理</a></li>
          <li><a href="#">公告信息维护</a></li>
          <li><a href="#">系统内账户维护</a></li>
        </ul>
      </li>
       <li>
        <div class="link">
          <i class="fa fa-globe"></i> 系统管理
          <i class="fa fa-chevron-down"></i>
        </div>
        <ul class="submenu">
          <li><a href="#">系统功能树管理</a></li>
          <li><a href="#">系统角色管理</a></li>
          <li><a href="#">公告信息维护</a></li>
          <li><a href="#">系统内账户维护</a></li>
        </ul>
      </li>
       <li>
        <div class="link">
          <i class="fa fa-globe"></i> 系统管理
          <i class="fa fa-chevron-down"></i>
        </div>
        <ul class="submenu">
          <li><a href="#">系统功能树管理</a></li>
          <li><a href="#">系统角色管理</a></li>
          <li><a href="#">公告信息维护</a></li>
          <li><a href="#">系统内账户维护</a></li>
        </ul>
      </li>
    </ul>
  	</div>   
  </aside>
  <!-- 主页区域 -->
  <section id="main" class="page-wrap">
  <!-- 页头导航 -->
    <nav id="header" class="navbar navbar-default" role="navigation">
      <div class="container-fluid">
        <div class="navbar-header">
          <a href="javascript:;" id="btnToggle" class="btn-toggle">
            <i class="fa fa-bars"></i>
          </a>
          <form role="search" class="navbar-form" method="post" action="#">
              <div class="form-group">
                  <input type="text" placeholder="请输入要查找内容 …" class="form-control" name="top-search" id="top-search">
              </div>
          </form>
        </div>
        <ul class="navbar-nav pull-right"> 
        	<li class="dropdown">
              <a class="dropdown-toggle count-info" data-toggle="dropdown" href="#" aria-expanded="false">
                  <i class="fa fa-bell"></i> <span class="label label-warning">8</span>
              </a>
              <ul class="dropdown-menu dropdown-alerts">
                  <li>
                      <a href="mailbox.html">
                          <div>
                              <i class="fa fa-envelope fa-fw"></i> 您有16条未读消息
                              <!-- <span class="pull-right text-muted small">4分钟前</span> -->
                          </div>
                      </a>
                  </li>
                  <li class="divider"></li>
                  <li>
                      <a href="profile.html">
                          <div>
                              <i class="fa fa-qq fa-fw"></i> 3条新回复
                              <!-- <span class="pull-right text-muted small">12分钟钱</span> -->
                          </div>
                      </a>
                  </li>
                  <li class="divider"></li>
                  <li>
                      <div class="text-center link-block">
                          <a class="J_menuItem" href="notifications.html">
                              <strong>查看所有 </strong>
                              <i class="fa fa-angle-right"></i>
                          </a>
                      </div>
                  </li>
              </ul>
          </li>
	        <li class="dropdown personal-center">
					    <a href="javascript:;" class="dropdown-toggle" id="personMenu" data-toggle="dropdown">
					    	<img src="img/avatar.jpg" alt="头像">
					    	<span class="username">悦视觉</span>
					      <span class="caret"></span>
					    </a>
					    <ul class="dropdown-menu" role="menu" aria-labelledby="personMenu">
					        <li role="presentation">
					            <a role="menuitem" tabindex="-1" href="#">个人中心</a>
					        </li>
					        <li role="presentation" class="divider"></li>
					        <li role="presentation">
					            <a role="menuitem" tabindex="-1" href="#">设置</a>
					        </li>
					        <li role="presentation" class="divider"></li>
					        <li role="presentation">
					            <a role="menuitem" tabindex="-1" href="signin.html">退出</a>
					        </li>
					    </ul>
					</li>
        </ul>
      </div>
    </nav>
    <!-- 主内容区域 -->
    <section class="main-content animated fadeInRight">
    	<div class="container-fluid">
        <div class="row">
          <div class="col-md-3">
            <h2 class="page-header">部门结构</h2>
            <ul id="treeDemo" class="ztree"></ul>
          </div>
          <div class="col-md-5">
            <h2 class="page-header">信息展示</h2>
            <form action="#" class="form-horizontal" role="form">
              <div class="form-group">
                <label class="col-sm-2 control-label">员工编号</label>
                <div class="col-sm-10">
                  <input type="text" id="departId" class="form-control">
                </div>
              </div>
              <div class="form-group">
                <label class="col-sm-2 control-label">员工名称</label>
                  <div class="col-sm-10">
                    <input type="text" id="departName" class="form-control">
                  </div>
              </div>
              <div class="form-group">
                <label class="col-sm-2 control-label">部门编号</label>
                <div class="col-sm-10">
                  <input type="text" id="parentId" class="form-control">
                </div>
              </div>
              <div class="form-group">
                <div class="col-sm-offset-4 col-sm-6">
                  <button class="btn btn-primary">确定</button>
                 <!--  <button id="update" class="btn btn-warning">修改</button>
                  <button id="remove" class="btn btn-danger">删除</button> -->
                </div>
              </div>
            </form>
          </div>
        </div>
    		<div class="row">
          <h2 class="page-header">JSON数据</h2>
          <div class="col-md-8">
             <textarea name="" id="output" class="form-control" cols="60" rows="10"></textarea>
          </div>  
        </div>
    	</div>
    </section>
    <!-- 页脚区域 -->
    <footer class="site-footer">
      <span>Copyright © 2016 yueshijue.com</span>
    </footer>
  </section>
  <script src="js/jquery.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="plugins/zTree/js/jquery.ztree.all.min.js"></script>
  <script src="js/main.js"></script>
  <script>
    var setting = {
      view: {
        addHoverDom: addHoverDom,
        removeHoverDom: removeHoverDom,
        selectedMulti: true
      },
      edit: {
        enable: true,
        showRenameBtn: showRenameBtn,
        showRemoveBtn: showRemoveBtn,
        drag: {
          isMove: true
        }
      },
      data: {
        simpleData: {
          enable: true
        }
      },
      check: {
        enable: true
      },
      callback: {
        beforeRemove: beforeRemove,
        beforeRename: beforeRename,
        onCheck: triggerEvent,
        onRemove: triggerEvent,
        onRename: triggerEvent,
        onDrop: triggerEvent,
        onNodeCreated: triggerEvent,
        onClick: HandlerClick,
      }
    }
    function beforeRemove(treeId, treeNode) {
      var zTree = $.fn.zTree.getZTreeObj("treeDemo");
      zTree.selectNode(treeNode);
      return confirm("确认删除 节点 -- " + treeNode.name + " 吗？");
    }
    function beforeRename(treeId, treeNode, newName, isCancel) {
      if (newName.length === 0) {
        setTimeout(function() {
          var zTree = $.fn.zTree.getZTreeObj("treeDemo");
          zTree.cancelEditName();
          alert("节点名称不能为空");
        }, 0);
        return false;
      }
      return true;
    }
    var newCount = 1;
    function addHoverDom(treeId, treeNode) {
      var sObj = $("#" + treeNode.tId + "_span");
      if (treeNode.editNameFlag || $("#addBtn_"+treeNode.tId).length>0) return;
      var addStr = "<span class='button add' id='addBtn_" + treeNode.tId
        + "' title='add node' onfocus='this.blur();'></span>";
      sObj.after(addStr);
      var btn = $("#addBtn_"+treeNode.tId);
      if (btn) btn.bind("click", function(){
        var zTree = $.fn.zTree.getZTreeObj("treeDemo");
        zTree.addNodes(treeNode, {id:(100 + newCount), pId:treeNode.id, name:"new node" + (newCount++)});
        return false;
      });
    };
    function removeHoverDom(treeId, treeNode) {
      $("#addBtn_"+treeNode.tId).unbind().remove();
    };
    function showRenameBtn(treeId, treeNode){
      return !treeNode.isLastNode;
    }
    function showRemoveBtn(treeId, treeNode){
      return !treeNode.isParent;
    }
    function triggerEvent(event, treeId, treeNode){
      $('#output').val(window.JSON.stringify(treeNode))
    }
    function HandlerClick(event, treeId, treeNode){
      var id = treeNode.id;
      var name = treeNode.name;
      var parentId = treeNode.parentTId;
      $('#departId').val(id)
      $('#departName').val(name)
      $('#parentId').val(parentId)
    }
    // var zNodes = [{
    //   name: "部门1",
    //   open: true,
    //   children: [{
    //     name: "员工1_1"
    //   }, {
    //     name: "员工1_2"
    //   }]
    // }, {
    //   name: "部门2",
    //   open: true,
    //   children: [{
    //     name: "员工2_1"
    //   }, {
    //     name: "员工2_2"
    //   }]
    // }];
    var zNodes =[
      { id:1, pId:0, name:"部门 1", open:false},
      { id:11, pId:1, name:"员工 1-1"},
      { id:12, pId:1, name:"员工 1-2"},
      { id:13, pId:1, name:"员工 1-3"},
      { id:2, pId:0, name:"部门 2", open:true},
      { id:21, pId:2, name:"员工 2-1"},
      { id:22, pId:2, name:"员工 2-2"},
      { id:23, pId:2, name:"员工 2-3"},
      { id:3, pId:0, name:"部门 3", open:true},
      { id:31, pId:3, name:"员工 3-1"},
      { id:32, pId:3, name:"员工 3-2"},
      { id:33, pId:3, name:"员工 3-3"}
    ];
    $(function(){
      $.fn.zTree.init($('#treeDemo'), setting, zNodes)
    })
  </script>
</body>
</html>